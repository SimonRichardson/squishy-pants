<!doctype html>
<html>
  <head>
    <title>Match with squishy-pants.js</title>
    <meta charset="utf-8" />
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <script src="../bin/squishy-pants.js"></script>
    <script>
      function event(element, name, callback) {
          if(element.addEventListener) {
              element.addEventListener(name, callback, false);
          } else {
              element.attachEvent('on' + name, callback);
          }
      }

      event(window, 'load', function() {
          var _ = squishy,

              // Monad which contains state and can do IO.
              M = _.State.StateT(_.IO),

              // Load 2 files, concatenate them to the start state and print the result.
              program =
                  M.lift(generateRandomString())
                  .chain(_.compose(M.modify, prependTo))
                  .chain(_.constant(M.lift(generateRandomString())))
                  .chain(_.compose(M.modify, prependTo))
                  .chain(_.constant(M.get))
                  .chain(_.compose(M.lift, println));

          function prependTo(a) {
              return function(b) {
                  return b + a;
              };
          }

          function generateRandomString() {
              return _.IO(function() {
                  return _.arb(String, 100);
              });
          }

          function println(s) {
              return _.IO(function() {
                  console.log(s);
              });
          }

          program.execState('').unsafePerform();
      });

    </script>
  </head>
  <body>
    <div class="container">
      <div class="row">
        <div class="span8 offset2">
          <h1>Match using <a href="https://github.com/SimonRichardson/squishy-pants">squishy-pants.js</a></h1>
          <hr />
          <div class="alert">
              <pre>
// Monad which contains state and can do IO.
var M = StateT(IO),

// Load 2 files, concatenate them to the start state and print the result.
program =
    M.lift(generateRandomString())
    .chain(_.compose(M.modify, prependTo))
    .chain(_.constant(M.lift(generateRandomString())))
    .chain(_.compose(M.modify, prependTo))
    .chain(_.constant(M.get))
    .chain(_.compose(M.lift, println));

program.exec('').unsafePerform();
              </pre>
          </div>
          <hr />
          <div class="alert" id="output"></div>
        </div>
      </div>
    </div>
  </body>
</html>
